{
"version":"2.0",
"description":"run bwa mem to to align input bam to supplied reference genome",
"subgraph_io":{
	"ports":{
		"inputs":{
		},
		"outputs":{
			"_stdout_":"crammerge"
		}
	}
},
"subst_params":[],
"nodes":[
	{
		"id":"order_target",
		"type":"EXEC",
		"use_STDIN": false,
		"use_STDOUT": true,
		"cmd": {"select":"ppi_in_target_order_command", "default":"sort", "select_range":[1], "cases":{
			"sort":[
				"samtools",
				"sort",
				{"select":"ppi_sort_input_order", "default":"name_alphanum", "select_range":[1], "cases":{
					"name_alphanum":"-n",
					"name_lexicog":"-N",
					"coord":[]
				}},
				"-u",
				{"select":"ppi_in_target_input_format", "default":"cram", "select_range":[1], "cases":{
					"cram":["--input-fmt-option", "no_ref=1"],
					"bam":["--input-fmt", "bam"]
				}},
				"--threads", {"subst":"ppi_in_target_threads","required":true,"ifnull":3},
				{"subst":"ppi_in_target", "required":true}
			],
			"collate":[
				"samtools",
				"collate",
				"-f",
				"-u",
				{"select":"ppi_in_target_input_format", "default":"cram", "select_range":[1], "cases":{
					"cram":["--input-fmt-option", "no_ref=1"],
					"bam":["--input-fmt", "bam"]
				}},
				"--threads", {"subst":"ppi_in_target_threads","required":true,"ifnull":3},
				{"subst":"ppi_in_target", "required":true}
			]
			}
		},
		"description":"order target input files"
	},
	{
		"id":"order_human",
		"type":"EXEC",
		"use_STDIN": false,
		"use_STDOUT": true,
		"cmd": {"select":"ppi_in_human_order_command", "default":"sort", "select_range":[1], "cases":{
			"sort":[
				"samtools",
				"sort",
				{"select":"ppi_sort_input_order", "default":"name_alphanum", "select_range":[1], "cases":{
					"name_alphanum":"-n",
					"name_lexicog":"-N",
					"coord":[]
				}},
				"-u",
				{"select":"ppi_in_human_input_format", "default":"cram", "select_range":[1], "cases":{
					"cram":["--input-fmt-option", "no_ref=1"],
					"bam":["--input-fmt", "bam"]
				}},
				"--threads", {"subst":"ppi_in_target_threads","required":true,"ifnull":3},
				{"subst":"ppi_in_human", "required":true}
			],
			"collate":[
				"samtools",
				"collate",
				"-f",
				"-u",
				{"select":"ppi_in_human_input_format", "default":"cram", "select_range":[1], "cases":{
					"cram":["--input-fmt-option", "no_ref=1"],
					"bam":["--input-fmt", "bam"]
				}},
				"--threads", {"subst":"ppi_in_human_threads","required":true,"ifnull":3},
				{"subst":"ppi_in_human", "required":true}
			]
			}
		},
		"description":"order human input files"
	},
	{
		"id":"crammerge",
		"type":"EXEC",
		"use_STDIN": false,
		"use_STDOUT": true,
		"cmd": [
			"samtools",
			"merge",
			{"select":"ppi_sort_input_order", "default":"name_alphanum", "select_range":[1], "cases":{
				"name_alphanum":"-n",
				"name_lexicog":"-N",
				"coord":[]
			}},
			{"select":"ppi_merge_rg_flag", "default":"on", "select_range":[1], "cases":{ "on":"-c", "off":[] }},
			{"select":"ppi_merge_pg_flag", "default":"on", "select_range":[1], "cases":{ "on":"-p", "off":[] }},
			"-O", "BAM",
			"-l", "0",
			{"select":"input_format", "default":"cram", "select_range":[1], "cases":{
				"cram":["--input-fmt-option", "no_ref=1"],
				"bam":["--input-fmt", "bam"]
			}},
			{"subst":"ppi_merge_arbitrary_flags"},
			"-",
			{"port":"in_target", "direction":"in"},
			{"port":"in_human", "direction":"in"}
		],
		"description":"merge reordered cram files into one bam file"
	}
],
"edges":[
	{ "id":"sort_input_target_to merge", "from":"order_target", "to":"crammerge:in_target" },
	{ "id":"sort_input_human_to merge", "from":"order_human", "to":"crammerge:in_human" }
]
}
